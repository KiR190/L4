# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π gRPC Grep

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ grep, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—â–∞—è –∑–∞–¥–∞—á–∏ –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å–µ—Ä–≤–µ—Ä–∞–º —á–µ—Ä–µ–∑ gRPC.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker Compose)

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏—Å—Ç–µ–º—É ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker Compose –¥–ª—è –ø–æ–¥–Ω—è—Ç–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤, –∞ –∫–ª–∏–µ–Ω—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ.

### 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤

```bash
docker-compose up -d --build
```

–ë—É–¥—É—Ç –∑–∞–ø—É—â–µ–Ω—ã 3 —É–∑–ª–∞ (`server1`, `server2`, `server3`), –ø–æ—Ä—Ç—ã –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–±—Ä–æ—à–µ–Ω—ã –Ω–∞ —Ö–æ—Å—Ç: `50051`, `50052`, `50053`.

### 2. –ó–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç –ª–æ–∫–∞–ª—å–Ω–æ, –ø–æ–¥–∫–ª—é—á–∏–≤—à–∏—Å—å –∫ —Å–µ—Ä–≤–µ—Ä–∞–º –Ω–∞ `localhost`:

```bash
# –ü—Ä–∏–º–µ—Ä: –ü–æ–∏—Å–∫ —Å–ª–æ–≤–∞ "ERROR" –≤ —Ñ–∞–π–ª–µ big.txt —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Å—Ç—Ä–æ–∫
go run client/main.go -servers=localhost:50051,localhost:50052,localhost:50053 -n "ERROR" big.txt
```

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ –§–ª–∞–≥–∏

–ö–ª–∏–µ–Ω—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ñ–ª–∞–≥–∏, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ `grep`:

-   `-i`: –†–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø–æ–∏—Å–∫.
-   `-v`: –ò–Ω–≤–µ—Ä—Å–∏—è (–ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–æ–∫–∏, –ù–ï —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω).
-   `-c`: –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π (—Å—É–º–º–∞—Ä–Ω–æ –ø–æ –≤—Å–µ–º —É–∑–ª–∞–º).
-   `-n`: –ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫ (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ).
-   `-A N`: –ü–æ–∫–∞–∑–∞—Ç—å N —Å—Ç—Ä–æ–∫ **–ü–æ—Å–ª–µ** —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è.
-   `-B N`: –ü–æ–∫–∞–∑–∞—Ç—å N —Å—Ç—Ä–æ–∫ **–ü–µ—Ä–µ–¥** —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ–º.
-   `-F`: –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (–±–µ–∑ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π).

### –ü—Ä–∏–º–µ—Ä—ã

**–ü–æ–∏—Å–∫ IP-–∞–¥—Ä–µ—Å–æ–≤ (Regex):**

```bash
go run client/main.go -servers=localhost:50051,localhost:50052 "\b([0-9]{1,3}\.){3}[0-9]{1,3}\b" test.txt
```

**–ü–æ–¥—Å—á–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö:**

```bash
go run client/main.go -servers=localhost:50051,localhost:50052,localhost:50053 -c "ERROR" big.txt
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

1.  **–ö–ª–∏–µ–Ω—Ç**: –ß–∏—Ç–∞–µ—Ç –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª, —Ä–∞–∑–±–∏–≤–∞–µ—Ç –µ–≥–æ –Ω–∞ —Ä–∞–≤–Ω—ã–µ —á–∞–Ω–∫–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –¥–æ—Å—Ç—É–ø–Ω—ã–º –≤–æ—Ä–∫–µ—Ä–∞–º.
2.  **–°–µ—Ä–≤–µ—Ä—ã**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å–≤–æ–π —á–∞–Ω–∫ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è –ø—É–ª –≥–æ—Ä—É—Ç–∏–Ω.
3.  **–ê–≥—Ä–µ–≥–∞—Ü–∏—è**: –ö–ª–∏–µ–Ω—Ç —Å–æ–±–∏—Ä–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —É—á–∏—Ç—ã–≤–∞—è –ø–æ—Ä—è–¥–æ–∫ —Å—Ç—Ä–æ–∫ –∏ –∫–≤–æ—Ä—É–º.

## –ö–≤–æ—Ä—É–º –∏ –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (N/2 + 1)

–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –∫–≤–æ—Ä—É–º–∞. –í –∫–ª–∞—Å—Ç–µ—Ä–µ –∏–∑ 3 —É–∑–ª–æ–≤ –∫–ª–∏–µ–Ω—Ç –æ–∂–∏–¥–∞–µ—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –æ—Ç **2 —Å–µ—Ä–≤–µ—Ä–æ–≤**.

-   –ï—Å–ª–∏ –æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä –ø–∞–¥–∞–µ—Ç, –∫–ª–∏–µ–Ω—Ç –≤—Å—ë —Ä–∞–≤–Ω–æ –≤–µ—Ä–Ω–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.
-   **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `server3` (`docker-compose stop server3`) –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–∏—Å–∫ —Å–Ω–æ–≤–∞ ‚Äî –æ–Ω —Å—Ä–∞–±–æ—Ç–∞–µ—Ç.

---

## –ë–µ–Ω—á–º–∞—Ä–∫–∏ –∏ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

–ú—ã —Å—Ä–∞–≤–Ω–∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞—à–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —É—Ç–∏–ª–∏—Ç–æ–π `grep`. –¢–µ—Å—Ç –ø—Ä–æ–≤–æ–¥–∏–ª—Å—è –Ω–∞ —Ñ–∞–π–ª–µ `big.txt` (1.5 –ú–ë, 16k —Å—Ç—Ä–æ–∫).

```bash
docker-compose exec client sh -c "grep -n 'ERROR' big.txt > expected.txt && /app/grep-client -servers=server1:50053,server2:50053,server3:50053 -n 'ERROR' big.txt > actual.txt && diff expected.txt actual.txt"
# (–ï—Å–ª–∏ –≤—ã–≤–æ–¥ –ø—É—Å—Ç ‚Äî —Ñ–∞–π–ª—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã)
```

### üîπ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç      | –í—Ä–µ–º—è (–ø—Ä–∏–±–ª.) | –£–∑–ª—ã | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ                 |
| :-------------- | :------------- | :--- | :------------------------- |
| `grep` (Linux)  | **0.03s**      | 1    | –ù–∞—Ç–∏–≤–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ |
| `mygrep` (gRPC) | **~0.05s**     | 3    | –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–µ—á–∞—Ç—å      |

> [!NOTE]  
> –ù–∞ –º–∞–ª—ã—Ö —Ñ–∞–π–ª–∞—Ö (–ú–ë) –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —Å–µ—Ç—å (gRPC overhead) –∑–∞–º–µ—Ç–Ω—ã, –∏ –ª–æ–∫–∞–ª—å–Ω—ã–π grep –±—ã—Å—Ç—Ä–µ–µ. –†–µ–∞–ª—å–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ `mygrep` —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –≥–∏–≥–∞–±–∞–π—Ç–Ω—ã—Ö –ª–æ–≥–∞—Ö –∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤, –≥–¥–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—é—Ç –ø—Ä–∏—Ä–æ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏.
